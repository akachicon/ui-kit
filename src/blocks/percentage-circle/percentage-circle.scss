@import '../../color';

// This function calculates transformations to fit
// circle stroke exactly in parent container.

@function calc-transform($containerWidth, $strokeWidth) {
  $scale: $containerWidth / ($containerWidth + $strokeWidth);
  $offsetPct: (1 - $scale) / 2 * 100%;

  @return (offsetPct: $offsetPct, scale: $scale);
}

@mixin circle-size-modifier($circleContainerWidth, $circleWidth) {
  & .percentage-circle__circle {
    $circleTransform: calc-transform($circleContainerWidth, $circleWidth);

    $offset: map-get($circleTransform, offsetPct);
    $scale: map-get($circleTransform, scale);

    stroke-width: $circleWidth;
    transform: translate($offset, $offset) scale($scale);
  }
}

.percentage-circle {
  position: relative;
  overflow: hidden;

  &__text {
    font-family: 'Lato Light', sans-serif;
    color: #9d9d9d;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  &__circle-container {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
  }

  &__circle {
    fill: transparent;
  }

  &_size {
    &_s {
      $blockSide: 3.88rem;

      width: $blockSide;
      height: $blockSide;

      & .percentage-circle__text {
        font-size: 1.63rem;
      }

      @include circle-size-modifier(
        $circleContainerWidth: $blockSide,
        $circleWidth: .24rem
      );
    }

    &_m {
      $blockSide: 5.94rem;

      width: $blockSide;
      height: $blockSide;

      & .percentage-circle__text {
        font-size: 2.5rem;
      }

      @include circle-size-modifier(
        $circleContainerWidth: $blockSide,
        $circleWidth: .37rem
      );
    }
  }

  &_color {
    &_terracotta {
      & .percentage-circle__circle {
        stroke: color(terracotta)
      }
    }

    &_turquoise {
      & .percentage-circle__circle {
        stroke: color(turquoise)
      }
    }
  }
}
